# L3_UI_統合UI設計

**作成日**: 2025年11月23日  
**カテゴリ**: 第3層 - 統合設計  
**バージョン**: 3.2  
**更新日**: 2025年12月31日

---

## 📖 このドキュメントについて

このドキュメントは、**3つのセクション（通い・泊まり・訪問）を統合したUIの設計**を定義します。

### v3.2での変更

1. **泊まりセクションの大幅変更を反映**
   - 未割当行の追加（10行構成）
   - 記号削除（入・○・退 → 苗字のみ）
   - 2コンテンツ高設計
   - ドラッグ&ドロップ操作

### v3.1での変更（参考）

1. **通いセクションの定員表示削除を反映**
   - 責任分界マップから通いの定員表示を削除
   - 定員管理は日別サマリーで行う

### v3.0での主要な変更（参考）

1. **画面構成の根本的な再設計**
   - カレンダーヘッダーを日別サマリーとメインコンテンツの間に配置
   - カレンダーヘッダーが「物差し」として機能
   
2. **カレンダーヘッダーの役割の明確化**
   - 日付・曜日の2行表示
   - 日別サマリーとメインコンテンツの縦軸基準
   - サンドイッチ配置による最適な視認性
   
3. **日別サマリーの修正**
   - 日付行を削除（3行のみ）
   - カレンダーヘッダーに日付表示を委譲
   
4. **ヘッダーの再構成**
   - 月切り替え、入出力、設定、ヘルプを統合
   - ナビゲーションタブは独立した行

5. **縦軸整列の設計要件（マスト）**
   - カレンダーヘッダー、日別サマリー、メインコンテンツの縦軸を完璧に揃える
   - CSS Grid Layoutによる実現

### 対象読者

- UI/UX担当者
- フロントエンド実装担当者
- テスト担当者

### 読了後に理解できること

- v3.0の画面構成（根本的な変更）
- カレンダーヘッダーの物差し機能
- 縦軸整列の設計方法
- サンドイッチ配置の意図
- 各セクションの責任分離

### 設計の前提

- **L2_通い_UI設計.md v4.0** の通いセクションUI
- **L2_泊まり_UI設計.md** の泊まりセクションUI
- **L2_訪問_UI設計.md** の訪問セクションUI
- **L1_技術_実装制約.md** のUI/UX規約
- **L0_業務_調整業務の制約.md** のリソース管理
- **L0_業務_居室管理の重要性.md** の夜勤負担度

---

## 1. 全体レイアウト（v3.0、v3.1変更なし）

### 1.1 画面構成

```
┌─────────────────────────────────────────────────┐
│ ヘッダー                                         │
│ ◀ 2025年11月 ▶ [入出力][設定][ヘルプ]          │
├─────────────────────────────────────────────────┤
│ ナビゲーションタブ                               │
│ [全体★] [通い] [泊まり] [訪問]                  │
├─────────────────────────────────────────────────┤
│ 日別サマリー（sticky固定） ▼                    │
│ ┌─────────────────────────────────────────────┐ │
│ │通 12 15 10  8 12 14 15  9 11 13 12 10 ...   │ │
│ │泊  5  9  6  4  7  8  9  5  6  8  7  5 ...   │ │
│ │訪  8 12 10  6  9 11 15  7  8 10  9  7 ...   │ │
│ └─────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────┤
│ カレンダーヘッダー（物差し・sticky固定）         │
│ ┌─────────────────────────────────────────────┐ │
│ │ 1  2  3  4  5  6  7  8  9 10 11 12 13 ...   │ │
│ │ 金 土 日 月 火 水 木 金 土 日 月 火 水 ...   │ │
│ └─────────────────────────────────────────────┘ │
│     ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓       │
├─────────────────────────────────────────────────┤
│ メインコンテンツ（スクロール可能）               │
│ ┌─────────────────────────────────────────────┐ │
│ │山田  ○  ○  ○  ○  ○  ○  ○  ○  ○ ...        │ │
│ │田中  ○     ○     ○     ○     ○ ...        │ │
│ │佐藤     ○     ○     ○     ○ ...           │ │
│ └─────────────────────────────────────────────┘ │
│     ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑       │
│     ← 縦軸が完璧に揃っている（マスト要件）       │
├─────────────────────────────────────────────────┤
│ フッター                                         │
│ 最終保存: 2025-11-29 14:30                      │
└─────────────────────────────────────────────────┘
```

**重要なポイント**:
1. **カレンダーヘッダーがサンドイッチ配置**（日別サマリーとメインコンテンツの間）
2. **日別サマリーは3行のみ**（日付行なし）
3. **縦軸が完璧に揃っている**（カレンダーヘッダーが物差し）
4. **日別サマリーとカレンダーヘッダーの両方がsticky固定**
5. **ヘッダーに月切り替えと入出力・設定・ヘルプが統合**

---

### 1.2 レイアウトの順序（v3.2変更なし）

```
上から順に:
1. ヘッダー
   ├─ 月切り替え（◀ 2025年11月 ▶）
   └─ 機能ボタン（入出力、設定、ヘルプ）

2. ナビゲーションタブ
   └─ 全体、通い、泊まり、訪問

3. 日別サマリー（sticky）
   └─ 3行（通い・泊まり・訪問）

4. カレンダーヘッダー（sticky）
   └─ 2行（日付・曜日）

5. メインコンテンツ
   └─ 各セクションのグリッド
```

---

## 4. 責任分界マップ（v3.1更新）

このセクションは、「誰が何を作るか」を明確にします。

### カレンダーヘッダー

- **責任者**: L3_UI_統合UI設計.md
- **内容**: 日付行、曜日行
- **CSS変数**: `--date-cell-width`
- **関係セクション**: 全セクション（通い・泊まり・訪問）
- ⚠️ **注意**: 各セクションはカレンダーヘッダーを作らない

---

### 通いセクション（v3.1更新）

- **責任者**: L2_通い_UI設計.md v4.0
- **内容**: 利用者行、スケジュールセル、**罫線による泊まり表現**
- **CSS変数**: `--label-column-width`, `--date-cell-width`（縦軸整列のため）
- ⚠️ **注意**: カレンダーヘッダーは作らない（L3の責任）

**詳細な責任範囲**:
- ✅ 利用者名列（縦軸ラベル）
- ✅ スケジュールセル（○◓◒の表示）
- ✅ 罫線による泊まり表現（青/薄青）
- ✅ セルクリック時のトグル処理（短押し）
- ✅ 長押しによるカレンダー表示（泊まり期間設定）
- ❌ ~~定員表示~~ **（v3.1で削除：日別サマリーで管理）**
- ❌ 日付ヘッダー（L3の責任）
- ❌ 月切り替えボタン（L3の責任）

**v3.1での変更点**:
- 定員表示を削除（前半/15人、後半/15人は表示しない）
- 定員管理は日別サマリーで一元管理

---

### 泊まりセクション（v3.2更新）

- **責任者**: L2_泊まり_UI設計.md v4.0
- **内容**: **未割当行**、居室行、予約セル、定員表示
- **CSS変数**: `--label-column-width`, `--date-cell-width`（縦軸整列のため）
- ⚠️ **注意**: カレンダーヘッダーは作らない（L3の責任）

**詳細な責任範囲**:
- ✅ **未割当行**（roomId = null の予約を縦積み表示）
- ✅ 居室名列（縦軸ラベル）
- ✅ **予約セル（苗字のみ表示、記号なし）**
- ✅ **2コンテンツ高設計**（入所=下半分、退所=上半分、連泊=中央）
- ✅ 定員表示（本日/9人、明日/9人、明後日/9人）
- ✅ **ドラッグ&ドロップ操作**（部屋割り当て/解除/変更）
- ❌ 日付ヘッダー（L3の責任）

**v3.2での変更点**:
- 未割当行を追加（10行構成）
- 記号削除（入・○・退 → 苗字のみ）
- 2コンテンツ高設計追加
- ドラッグ&ドロップ操作追加

---

### 訪問セクション（v3.2変更なし）

- **責任者**: L2_訪問_UI設計.md
- **内容**: 利用者行、訪問セル、時間帯表示
- **CSS変数**: `--label-column-width`, `--date-cell-width`（縦軸整列のため）
- ⚠️ **注意**: カレンダーヘッダーは作らない（L3の責任）

**詳細な責任範囲**:
- ✅ 利用者名列（縦軸ラベル）
- ✅ 訪問セル（時間帯・回数の表示）
- ✅ 訪問リソース表示
- ❌ 日付ヘッダー（L3の責任）

---

### 日別サマリー（v3.2変更なし）

- **責任者**: U3_UI_日別サマリー.md
- **内容**: 日別のサマリー情報（通い・泊まり・訪問の集計）
- **配置**: カレンダーヘッダーの上
- **CSS変数**: `--date-cell-width`（縦軸整列のため）
- **機能**: 定員管理、稼働率の可視化

**v3.1での重要性**:
- 通いセクションから定員表示が削除されたため、日別サマリーが唯一の定員表示
- 各日の通い人数を一目で確認できる

---

## 📚 次に読むべきドキュメント（v3.2変更なし）

このドキュメントを読了したら、以下のドキュメントに進んでください。

### 関連ドキュメント

- **U3_UI_日別サマリー.md v2.0** - 日別サマリーの詳細
- **L2_通い_UI設計.md v4.0** - 通いセクションの詳細
- **L2_泊まり_UI設計.md** - 泊まりセクションの詳細
- **L2_訪問_UI設計.md** - 訪問セクションの詳細

---

## 📝 参考資料（v3.2変更なし）

- L1_概要_プロジェクト概要.md（セクション独立性の原則）
- L1_技術_実装制約.md（UI/UX規約）
- U3_UI_日別サマリー.md v2.0（縦軸整列）
- CHECKLIST_設計レビュー.md（UI設計の原則）

---

## 📅 更新履歴

| 日付 | バージョン | 変更内容 | 担当 |
|------|----------|---------|------|
| 2025-11-23 | 1.0 | 初版作成 | Claude |
| 2025-11-29 | 3.0 | カレンダーヘッダーサンドイッチ配置、縦軸整列強化 | Claude |
| 2025-12-19 | 3.1 | 通いセクションの定員表示削除を反映 | Claude |
| 2025-12-31 | 3.2 | 泊まりセクションの未割当行・D&D追加を反映 | Claude |

---

**最終更新**: 2025年12月31日  
**次回更新予定**: Phase 1実装中のフィードバック反映時

---

## ⚠️ 設計チェックリスト（v3.2）

このドキュメントの品質チェック：

- [x] 画面構成が明確
- [x] カレンダーヘッダーの配置が明確
- [x] 日別サマリーの役割が明確
- [x] 縦軸整列の設計が詳細
- [x] CSS変数の使用が明記
- [x] 各セクションの責任分離が明確
- [x] 通いセクションの定員表示削除が反映
- [x] 責任分界マップが更新されている

---

**このドキュメントを読了したら、INDEX_ドキュメント構成.md に戻り、次のドキュメントに進んでください。**