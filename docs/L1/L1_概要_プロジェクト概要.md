# L1_概要_プロジェクト概要

**作成日**: 2025年11月22日  
**カテゴリ**: 第1層 - 基礎  
**バージョン**: 3.0  
**更新日**: 2025年12月8日

---

## 📖 このドキュメントについて

このドキュメントは、**プロジェクトBの全体像**を定義します。特に、**3人体制（ユーザー・Claude・GitHub Copilot）での協働**を前提とした設計・実装の方針を明確にします。

### 対象読者

- **ユーザー**（プロジェクトオーナー）
- **Claude**（設計担当）
- **GitHub Copilot**（実装担当）

### 読了後に理解できること

- プロジェクトの本質（制約パズル）
- 何をやるのか、何をやらないのか（Phase 1のスコープ）
- 3人の役割と協働フロー
- **設計・実装の方針**（最重要：GitHub Copilotの誤実装を防ぐ）
- 技術制約と成功の定義

### v3.0での主要な変更

- **セクション6「設計・実装の方針」を独立ドキュメント化**（316行 → 60行）
- **L1_設計・実装の方針.md を新規作成**（詳細を移動）
- **Phase 2/3の概略を追加**（道筋の明確化）
- **「プロジェクト概要」の定義を明確化**：ゴール + 道筋の概略
- **947行 → 約650行（-31%）**

### v2.0での主要な変更

- **3人体制を前提とした構成**（従来: 複数人チーム前提）
- **セクション6「設計・実装の方針」を316行に拡充**（従来: 20行）← v3.0で独立
- **Phase 1に集中**（Phase 2/3の詳細を削除）
- **セクション独立性の説明を削減**（並行開発は実態と異なる）
- **1,432行 → 947行（-34%）**

---

## 1. プロジェクトの本質

### 1.1 調整業務は制約パズル

小規模多機能型居宅介護の利用調整業務は、**制約パズル**です。

```
同時に満たすべき制約：
├─ 登録定員29人
├─ 通い定員15人（前半・後半別）
├─ 泊まり定員9人
├─ 夜勤1人体制のリスク
├─ 職員配置基準
├─ 利用者の希望
├─ 送迎ルート
└─ 突発的な変更

→ これらを同時に満たす「解」を見つける
```

**参照**: L0_業務_調整業務の制約.md

---

### 1.2 属人性の問題

現状、この制約パズルは「ベテランの頭の中」で解かれています。

```
問題：
├─ 新人が育たない
├─ ベテランが異動すると業務が回らなくなる
├─ 調整の根拠が記録に残らない
└─ 空き状況がすぐわからない（問い合わせに5-10分）
```

---

### 1.3 プロジェクトBの目的

**「制約パズル」を可視化し、誰でも解けるようにする**

```
目標：
├─ 制約の可視化（色分け、即フィードバック）
├─ 定員チェックの自動化
├─ 空き状況の即答（5秒以内）
├─ 試行錯誤の容易さ（Ctrl+Z、ドラッグ）
└─ 調整の履歴管理

→ パズルとして「楽しく」解ける
→ 属人性の軽減
```

---

### 1.4 「パズル」としてのアプローチ

```
従来のシステム：
「業務を効率化する」
  ↓
義務感、負担感

プロジェクトB：
「パズルを解く」
  ↓
達成感、楽しさ
```

**重要**: 制約を敵ではなく、パズルの「ルール」として捉える

---

## 2. スコープ

### 2.1 Phase 1でやること

```
✅ 3セクションの月別予定表
  ├─ 通いセクション（利用者×日付）
  ├─ 泊まりセクション（居室×日付）
  └─ 訪問セクション（時間帯×回数）

✅ 制約の可視化
  ├─ 定員チェックの自動化
  ├─ 色分け（超過:赤、ギリギリ:黄）
  └─ 即フィードバック（0.2秒）

✅ データ連携
  ├─ 算定基礎CSVのインポート
  └─ 週間パターンの月間展開

✅ 基本操作
  ├─ 予定の入力・編集・削除
  ├─ Ctrl+Z（元に戻す）
  └─ ドラッグ移動（試行錯誤の容易さ）

✅ ブラウザ完結
  ├─ サーバー不要
  ├─ localStorage（データ永続化）
  └─ オフラインで動作
```

---

### 2.2 Phase 1でやらないこと

```
❌ サーバー連携（Phase 2）
❌ 複数デバイス共有（Phase 2）
❌ 認証機能（Phase 2）
❌ スコアリング・AI提案（Phase 3）
❌ 成長の可視化（Phase 3）
❌ 送迎ルート最適化（Phase 3）
❌ 介護ソフトとの自動連携（Phase 2以降で検討）
```

**重要**: Phase 1は「3セクション完成版（ブラウザ完結）」

---

### 2.3 Phase 1の成功基準

```
✓ 1事業所で実運用開始
✓ 3セクションすべての月別予定表が紙から置き換わる
✓ 調整担当者が「使いやすい」と評価
✓ 定員チェックの自動化率100%
✓ 空き状況への回答時間：5-10分 → 5秒以内
```

---

## 3. システムの全体像

### 3.1 3つのセクション

```
┌─────────────────────────────────────┐
│ 日別サマリー                         │
│ 通い: 12/15  泊まり: 7/9  訪問: 3回 │
└─────────────────────────────────────┘
         ↓
┌─────────────────────────────────────┐
│ タブ: [全体] [通い] [泊まり] [訪問] │
└─────────────────────────────────────┘
         ↓
┌─────────────────────────────────────┐
│ メインコンテンツ（タブで切り替え）   │
│                                     │
│ 通いセクション:                     │
│   利用者×日付のマトリクス            │
│                                     │
│ 泊まりセクション:                   │
│   居室×日付のマトリクス              │
│                                     │
│ 訪問セクション:                     │
│   時間帯×回数のマトリクス            │
└─────────────────────────────────────┘
```

---

### 3.2 セクション独立性

**3つのセクションは独立**しています。

```
通いセクション：
  ├─ データ: KayoiSchedule
  ├─ UI: #kayoi-section
  └─ ロジック: kayoi.js

泊まりセクション：
  ├─ データ: TomariReservation
  ├─ UI: #tomari-section
  └─ ロジック: tomari.js

訪問セクション：
  ├─ データ: HomonSchedule
  ├─ UI: #homon-section
  └─ ロジック: homon.js

→ 相互参照しない
→ 1つのセクションだけテスト可能
→ 1つのセクションの修正が他に影響しない
```

**詳細**: L2_各セクション_データ構造.md を参照

---

### 3.3 UI構成の原則

```
原則1: 横スクロール禁止
  ├─ 31日分を画面幅に収める
  ├─ calc((100vw - 80px - 30px) / 31)
  └─ overflow-x: hidden

原則2: 縦軸の完璧な整列
  ├─ カレンダーヘッダー
  ├─ 日別サマリー
  └─ メインコンテンツ
  → すべて同じセル幅

原則3: 即フィードバック
  └─ 0.2秒のフェードアニメーション

原則4: 印刷も想定
  ├─ A4横で1-2枚
  └─ 白黒印刷でも見やすい
```

**詳細**: L1_技術_実装制約.md を参照

---

## 4. 段階的実装戦略（Phase 1のみ）

### 4.1 Phase 1の目標

**3セクション完成版（ブラウザ完結型）**

- 通い・泊まり・訪問の3セクションすべてが動作
- 制約の可視化、定員チェックの自動化
- 実用レベルのUI/UX
- 1事業所で実運用可能

---

### 4.2 技術スタック

```
フロントエンド:
├─ HTML/CSS/JavaScript（バニラJS）
├─ CSS Grid Layout
└─ 0.2秒フェードアニメーション

データ永続化:
└─ localStorage

外部依存:
└─ なし（完全ブラウザ完結）
```

---

### 4.3 機能一覧

#### 通いセクション
```
✓ 月別予定表（利用者×日付）
✓ 前半・後半の区別（○◓◒）
✓ 定員チェック（前半・後半別）
✓ 色分け（超過:赤、ギリギリ:黄）
✓ 即フィードバック
✓ Ctrl+Z（元に戻す）
```

#### 泊まりセクション
```
✓ 居室軸の月別予定表
✓ 期間管理（入→○→退）
✓ 居室割当
✓ 定員チェック（9人/日）
✓ 重度・中度・軽度の区別
```

#### 訪問セクション
```
✓ 時間帯別の回数表示
✓ 回数カウント
✓ 時間帯別管理（朝・昼・夕・夜）
```

#### CSV機能
```
✓ 算定基礎CSVインポート
✓ 週間パターンの月間展開
```

#### UI/UX
```
✓ シンプルで見やすいデザイン
✓ 0.2秒のフェードアニメーション
✓ Ctrl+Z（元に戻す）
✓ 横スクロール禁止
✓ 印刷対応（A4横）
```

---

### 4.4 実装の順序

```
Step 1: 通いセクション
  ↓ レビュー・修正
Step 2: 泊まりセクション
  ↓ レビュー・修正
Step 3: 訪問セクション
  ↓ レビュー・修正
Step 4: 統合・調整
  ↓ レビュー・修正
Step 5: 実運用開始
```

**重要**: 1セクションずつ完成させる（並行開発しない）

---

### 4.5 期間

**4-6ヶ月**（1セクション: 1-2ヶ月）

---

### 4.6 Phase 2以降の概略

Phase 1完了後の道筋（概略のみ）:

#### Phase 2: サーバー連携版（6-12ヶ月後）

```
目標: 複数デバイスでデータ共有

追加機能:
├─ バックエンドAPI
├─ データベース
├─ 認証機能
├─ 実績データの分析
└─ 算定基礎の推奨機能

期間: 3-6ヶ月
```

---

#### Phase 3: AI支援版（12-18ヶ月後）

```
目標: 調整業務をゲーム化

追加機能:
├─ スコアリング（制約違反の自動検出）
├─ AI提案（最適な調整案の提示）
├─ 成長の可視化（習熟度グラフ）
└─ 送迎ルート最適化

期間: 3-6ヶ月
```

**重要**: Phase 1完成後、実運用のフィードバックを踏まえて判断

---

## 5. プロジェクト体制

### 5.1 3人のメンバー

```
ユーザー（プロジェクトオーナー）
  ↓ 要件・業務知識・判断
Claude（設計担当）
  ↓ 実装指示書
GitHub Copilot（実装担当）
  ↓ コード
ユーザー（レビュー）
```

---

### 5.2 ユーザーの役割

```
役割：
├─ 要件定義
├─ 業務知識の提供
├─ 設計レビュー
├─ 実装レビュー
├─ 判断・承認
└─ フィードバック

重要な責務：
├─ 設計の曖昧さを指摘
├─ 実装のズレを検出
└─ Phase 1のスコープを守る
```

---

### 5.3 Claude（設計担当）の役割

```
役割：
├─ L0層（業務知識）の学習
├─ L1-L3層（設計書）の作成
├─ 実装指示書の作成
├─ LLM誤解予測レビューの実施
└─ 引継ぎドキュメントの作成

重要な責務：
├─ 曖昧さを排除する
├─ GitHub Copilotの誤実装を予測する
├─ データ型を明示する
├─ インタラクションを詳細に記述する
└─ 「やること」「やらないこと」を明記する
```

**Claudeは設計者であり、実装者ではない**

---

### 5.4 GitHub Copilot（実装担当）の役割

```
役割：
└─ 実装指示書に基づいた実装

特性：
├─ 「効率化の誘惑」に弱い
│   例: モーダルを勝手に作る、ライブラリを導入する
├─ 曖昧な指示で誤実装
│   例: 「日別サマリー」→ 5行（正しくはタブ別3行）
└─ 明確な指示と警告が必要
    例: 「❌ モーダルは使わない。左クリックでトグルのみ」
```

**GitHub Copilotは優秀だが、明確な指示が必要**

---

### 5.5 協働フロー

```
【設計フェーズ】
1. ユーザーが要件を説明
   ↓
2. Claudeが業務知識を学習（L0層を読む）
   ↓
3. Claudeがユーザーと対話しながら設計書を作成
   ↓
4. ユーザーが設計書をレビュー
   ↓（承認）

【実装指示書作成フェーズ】
5. Claudeが設計書を基に実装指示書を作成
   ↓
6. Claudeが「LLM誤解予測レビュー」を実施
   ↓
7. 実装指示書に警告セクションを追加
   ↓
8. ユーザーが実装指示書をレビュー
   ↓（承認）

【実装フェーズ】
9. GitHub Copilotが実装指示書を基に実装
   ↓
10. ユーザーが実装をレビュー
   ↓
11. ズレがあれば、Claudeが修正指示書を作成
   ↓
12. GitHub Copilotが修正
   ↓（完成）

【引継ぎフェーズ（チャット切り替え時）】
13. Claudeが引継ぎドキュメントを作成
   ↓
14. 次のClaudeが引継ぎドキュメントを読んで開始
```

**重要**: シーケンシャルな協働（並行作業しない）

---

## 6. 設計・実装の方針（概略）

### 6.1 設計品質の5原則

```
原則1: 曖昧さは実装時ではなく、設計時に排除する
原則2: データ型を明示する（文字列かDateか？）
原則3: インタラクションを詳細に記述する（クリックしたらどうなる？）
原則4: 状態遷移を図示する（どの状態からどの状態に遷移する？）
原則5: テスト仕様書を先に書く（何をテストすれば完成？）
```

**詳細**: L1_設計・実装の方針.md を参照

---

### 6.2 実装指示書の書き方

**必須要素**:
```
✓ 目的（WHY）
✓ 仕様（WHAT）
✓ 制約（DON'T）← 最重要
✓ データ型の明示
✓ インタラクションの詳細
✓ 状態遷移図
✓ テストケース
✓ 警告セクション← LLM誤解予測レビュー後に追加
```

**詳細**: L1_設計・実装の方針.md セクション2 を参照

---

### 6.3 LLM誤解予測レビュー

**GitHub Copilotの「効率化の誘惑」を予測し、先回りして警告する**

```
誘惑1: モーダルを作る
誘惑2: ライブラリを導入する
誘惑3: 仕様を簡略化する
誘惑4: 重複コードを削除する
誘惑5: CSS変数を無視する
```

**詳細**: L1_設計・実装の方針.md セクション3 を参照

---

### 6.4 レビューと引継ぎ

- 設計レビュー: CHECKLIST_設計レビュー.md を参照
- 実装レビュー: L1_設計・実装の方針.md セクション4 を参照
- 引継ぎ: GUIDE_引継ぎドキュメント作成ルール.md を参照

---

## 7. 技術制約

### 7.1 必須制約

```
✓ ブラウザ完結
  - サーバー不要
  - localStorage使用
  - オフラインで動作

✓ 横スクロール禁止
  - 31日分を画面幅に収める
  - overflow-x: hidden

✓ バニラJavaScript
  - ライブラリ・フレームワーク不使用
  - jQuery, React, Vue等を使わない

✓ CSS Grid Layout
  - table-layout: fixed
  - CSS変数で共通化

✓ 即フィードバック
  - 0.2秒のフェードアニメーション
  - transition: all 0.2s ease
```

---

### 7.2 推奨事項

```
✓ シンプルな実装
  - 複雑な抽象化を避ける
  - コメントを充実させる

✓ テストしやすさ
  - 純粋関数を優先
  - グローバル変数を最小限に

✓ パフォーマンス
  - DOMアクセスを最小限に
  - イベント委譲を使う
```

**詳細**: L1_技術_実装制約.md を参照

---

## 8. 成功の定義

### 8.1 Phase 1の成功基準

```
✓ 1事業所で実運用開始
✓ 3セクションすべての月別予定表が紙から置き換わる
✓ 調整担当者が「使いやすい」と評価
✓ 定員チェックの自動化率100%
✓ 空き状況への回答時間：5-10分 → 5秒以内
✓ 横スクロールが発生しない
✓ 縦軸が完璧に揃っている
```

---

### 8.2 定量的な目標

```
✓ 空き状況の回答時間: 5秒以内
✓ 定員チェックの精度: 100%
✓ データ入力の速度: 紙と同等以上
✓ 操作ミス率: 紙より低い
✓ 使用率: 週5日以上
```

---

### 8.3 定性的な目標

```
✓ 調整担当者が「楽しい」と感じる
✓ 新人が「わかりやすい」と感じる
✓ ベテランが「安心できる」と感じる
✓ 制約の可視化により「気づき」が生まれる
```

---

## 📚 次に読むべきドキュメント

### Phase 1の設計・実装を始める場合

```
1. L1_設計・実装の方針.md← NEW!
   - 設計品質の5原則
   - 実装指示書の書き方
   - LLM誤解予測レビュー
   所要時間: 20分

2. L1_データ_共通データ構造.md
   - 3セクション共通のデータ構造
   所要時間: 15分

3. L1_技術_実装制約.md
   - 技術的な制約の詳細
   所要時間: 15分

4. L2_通い_データ構造.md
   - 通いセクションの設計
   所要時間: 15分

5. L2_通い_UI設計.md
   - 通いセクションのUI設計
   所要時間: 15分

6. L2_通い_ロジック設計.md
   - 通いセクションのロジック設計
   所要時間: 20分
```

---

## 📅 更新履歴

| 日付 | バージョン | 変更内容 | 担当 |
|------|----------|---------|------|
| 2025-11-22 | 1.0 | 初版作成 | Claude |
| 2025-11-25 | 1.1 | Phase 1の詳細を追加 | Claude |
| 2025-12-08 | 2.0 | 3人体制を前提に全面書き直し、セクション6「設計・実装の方針」を316行に拡充（1,432行→947行） | Claude |
| 2025-12-08 | 3.0 | セクション6を独立ドキュメント化（L1_設計・実装の方針.md）、Phase 2/3の概略を追加、「プロジェクト概要」の定義を明確化（947行→約650行） | Claude |

---

**最終更新**: 2025年12月8日  
**次回更新予定**: Phase 1実装完了後、フィードバック反映時

---

## 💡 このドキュメントの活用方法

### 設計時

- **L1_設計・実装の方針.md を熟読**
- 設計書作成時は「5原則」を守る
- CHECKLIST_設計レビュー.mdでレビュー

### 実装指示書作成時

- **L1_設計・実装の方針.md セクション2 を参照**
- データ型を明示
- インタラクションを詳細に記述
- LLM誤解予測レビューを実施
- 警告セクションを追加

### 実装レビュー時

- **L1_設計・実装の方針.md セクション4 を参照**
- 設計書とのギャップを確認
- 警告が守られているか確認

### チャット切り替え時

- **GUIDE_引継ぎドキュメント作成ルール.md を参照**
- 引継ぎドキュメントを作成
- 必読ドキュメントを明示

---

**このドキュメントを読了したら、L1_設計・実装の方針.md に進んでください。**