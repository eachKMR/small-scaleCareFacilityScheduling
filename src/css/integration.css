/**
 * integration.css
 * 統合UI設計v2.1専用スタイル
 * 
 * L3_UI_統合UI設計.md v2.1に基づく実装
 */

/* ========================================
   列幅の統一設定（垂直対応の要）
   ======================================== */

:root {
  /* 日付列の幅を動的計算 */
  --date-column-width: calc((100vw - 150px) / 31); /* 画面幅から左端ラベル列を引いて31分割 */
  --date-column-min-width: 40px;
  --date-column-max-width: 60px;
  
  /* 実際の列幅（最小・最大の範囲内） */
  --column-width: clamp(
    var(--date-column-min-width),
    var(--date-column-width),
    var(--date-column-max-width)
  );
  
  /* 左端ラベル列の幅 */
  --label-column-width: 120px;
}

/* すべてのテーブルで共通の列幅を適用 */
.summary-table td:first-child,
.header-table th:first-child,
.schedule-grid td:first-child {
  width: var(--label-column-width);
  min-width: var(--label-column-width);
  max-width: var(--label-column-width);
}

.summary-table td:not(:first-child),
.header-table th:not(:first-child),
.schedule-grid td:not(:first-child) {
  width: var(--column-width);
  min-width: var(--column-width);
  max-width: var(--column-width);
}

/* テーブル共通設定 */
.summary-table,
.header-table,
.schedule-grid {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
  table-layout: fixed; /* 重要: 列幅を固定 */
}

/* ========================================
   統合ヘッダー（60px）
   ======================================== */

.unified-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 60px;
  padding: 0 20px;
  background-color: #2c3e50;
  color: white;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  position: sticky;
  top: 0;
  z-index: 1000;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 30px;
}

.unified-header .app-title {
  font-size: 20px;
  font-weight: bold;
  margin: 0;
  white-space: nowrap;
  color: white;
}

.calendar-controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

.calendar-controls #current-month {
  font-size: 18px;
  font-weight: bold;
  margin: 0;
  min-width: 120px;
  text-align: center;
}

.nav-button {
  background-color: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.nav-button:hover {
  background-color: rgba(255, 255, 255, 0.2);
}

.header-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

.unified-header .header-button {
  background-color: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.unified-header .header-button:hover {
  background-color: rgba(255, 255, 255, 0.2);
}

/* ========================================
   コンパクトタブ（40px）
   ======================================== */

.section-tabs.compact {
  display: flex;
  background-color: #ecf0f1;
  border-bottom: 2px solid #bdc3c7;
  padding: 0;
  margin: 0;
  height: 40px;
  position: sticky;
  top: 60px; /* 統合ヘッダーの下 */
  z-index: 999;
}

.section-tabs.compact .tab-button {
  flex: 0 0 auto; /* コンパクト：幅を自動調整 */
  min-width: 50px;
  max-width: 80px;
  padding: 8px 16px;
  background-color: transparent;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  color: #555;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.section-tabs.compact .tab-button:hover {
  background-color: rgba(52, 152, 219, 0.1);
  color: #2c3e50;
}

.section-tabs.compact .tab-button.active {
  background-color: white;
  border-bottom-color: #3498db;
  color: #3498db;
  font-weight: bold;
}

/* ========================================
   日別サマリー（コンパクト化）
   ======================================== */

.daily-summary {
  margin: 10px 0; /* 20px → 10px */
  background-color: #f8f9fa;
  border-bottom: 2px solid #dee2e6;
  padding: 4px 0; /* 新規追加：縦幅を縮小 */
}

.summary-table {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
}

.summary-row {
  border-bottom: 1px solid #e0e0e0;
  height: 22px; /* 新規追加：行の高さを制限 */
}

.summary-label {
  background-color: #f5f5f5;
  font-weight: 600; /* bold → 600 */
  text-align: right;
  padding: 4px 12px; /* 8px → 4px */
  border: 1px solid #ddd;
  width: var(--label-column-width);
  font-size: 12px; /* 新規追加：フォントサイズ縮小 */
  line-height: 1.2;
}

.summary-cell {
  text-align: center;
  padding: 4px 2px; /* 8px 4px → 4px 2px */
  border: 1px solid #ddd;
  font-size: 11px; /* 14px → 11px */
  width: var(--column-width);
  line-height: 1.2;
}

/* 定員状況の色分け */
.summary-cell.normal {
  background-color: transparent;
}

.summary-cell.warning {
  background-color: #fff3cd;
  color: #856404;
  font-weight: bold;
}

.summary-cell.full {
  background-color: #f8d7da;
  color: #721c24;
  font-weight: bold;
}

.summary-cell.over {
  background-color: #f5c6cb;
  color: #721c24;
  font-weight: bold;
  animation: pulse 1s ease infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

/* 介助量アイコン */
.care-icon {
  display: inline-block;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  margin: 0 1px;
  font-size: 10px;
}

.care-icon.heavy {
  background-color: #d32f2f;
  color: white;
}

.care-icon.medium {
  background-color: #ffa726;
  color: white;
}

.care-icon.light {
  background-color: #66bb6a;
  color: white;
}

/* ========================================
   カレンダー見出しのsticky固定
   ======================================== */

.calendar-header-sticky {
  position: sticky;
  top: 100px; /* 統合ヘッダー60px + コンパクトタブ40px */
  z-index: 98; /* タブより下 */
  background-color: white;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.header-table {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
}

.date-label-cell {
  width: var(--label-column-width);
  background-color: #f5f5f5;
  border: 1px solid #ddd;
}

.date-header {
  background-color: #f5f5f5;
  text-align: center;
  padding: 8px 4px;
  border: 1px solid #ddd;
  vertical-align: middle;
  width: var(--column-width);
}

.date-header .date {
  font-size: 16px;
  font-weight: bold;
  display: block;
}

.date-header .day {
  font-size: 12px;
  color: #666;
  display: block;
  margin-top: 2px;
}

/* 土曜日 */
.date-header .day.saturday {
  color: #0066cc;
}

/* 日曜日 */
.date-header .day.sunday {
  color: #cc0000;
}

/* ========================================
   セクション共通
   ======================================== */

.section {
  margin: 40px 0;
  padding: 20px;
  border: 1px solid #e0e0e0;
  border-radius: 4px;
  background-color: white;
}

.section-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 2px solid #007bff;
}

.section-content {
  overflow-x: visible; /* 横スクロールなし */
  overflow-y: visible; /* 縦スクロールなし（ページ全体でスクロール） */
}

/* 通いセクション */
.kayoi-section {
  border-left: 4px solid var(--color-kayoi, #4caf50);
}

/* 泊まりセクション */
.tomari-section {
  border-left: 4px solid var(--color-tomari, #ff9800);
}

/* 訪問セクション */
.houmon-section {
  border-left: 4px solid var(--color-houmon, #2196f3);
}

/* ========================================
   レスポンシブ対応
   ======================================== */

/* デスクトップ（1366px以上） */
@media (min-width: 1366px) {
  :root {
    --label-column-width: 120px;
    --date-column-min-width: 40px;
    --date-column-max-width: 60px;
  }
}

/* タブレット（768px-1365px） */
@media (min-width: 768px) and (max-width: 1365px) {
  :root {
    --label-column-width: 100px;
    --date-column-min-width: 35px;
    --date-column-max-width: 50px;
  }
  
  .date-header .date {
    font-size: 14px;
  }
  
  .date-header .day {
    font-size: 11px;
  }
}

/* スマートフォン（767px以下） */
@media (max-width: 767px) {
  /* Phase 2以降で対応 */
  /* 横スクロールを許可 */
  .main-content {
    overflow-x: auto;
  }
  
  :root {
    --label-column-width: 80px;
    --date-column-min-width: 30px;
    --date-column-max-width: 40px;
  }
}

/* ========================================
   印刷レイアウト
   ======================================== */

@media print {
  /* ヘッダー・タブ・フッターを非表示 */
  .unified-header,
  .section-tabs,
  .calendar-controls,
  .app-footer {
    display: none;
  }
  
  /* 日別サマリーを印刷 */
  .daily-summary {
    page-break-inside: avoid;
    margin-bottom: 20px;
  }
  
  /* カレンダー見出しのsticky解除 */
  .calendar-header-sticky {
    position: static;
  }
  
  /* セクションを印刷 */
  .section {
    page-break-inside: avoid;
    margin: 20px 0;
    border: 2px solid #333;
  }
  
  /* 改ページを適切に */
  .section-title {
    page-break-after: avoid;
  }
  
  .section-content {
    page-break-before: avoid;
  }
  
  /* 文字サイズを調整 */
  body {
    font-size: 10pt;
  }
  
  .summary-cell,
  .schedule-cell {
    padding: 4px;
    font-size: 9pt;
  }
}
